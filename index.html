<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Character encoding for the document -->
    <meta charset="UTF-8" />

    <!-- Responsive design settings to ensure proper rendering on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Compatibility settings for Internet Explorer -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <!-- Link to Bootstrap CSS for styling the page -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Link to Bootstrap Icons for using icon fonts -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Link to custom stylesheet for additional styles specific to the Blackjack game -->
    <link rel="stylesheet" href="css/blackjack_style.css" />

    <!-- Title of the webpage, displayed in the browser tab -->
    <title>Blackjack</title>
  </head>

  <body>
    <audio id="bg-music"></audio>

    <audio id="vfx-sounds"></audio>

    <!-- Header section containing the game title -->
    <header class="container">
      <h1>Blackjack 25</h1>
      <!-- Main heading for the game -->
    </header>

    <main class="container">
      <!-- Main game section -->
      <section id="game">
        <h2>Dealer</h2>
        <!-- Subheading for the dealer's section -->
        <p id="dealer"></p>
        <!-- Placeholder for displaying dealer's cards -->

        <h2>Player</h2>
        <!-- Subheading for the player's section -->
        <p id="player"></p>
        <!-- Placeholder for displaying player's cards -->

        <!-- Button for the player to draw a new card -->
        <button
          class="btn btn-primary"
          id="card"
          type="button"
          onclick="
          playerNewCard();
          playCardSoundDontWait();
          "
        >
          Card
        </button>

        <!-- Button for the player to stand (end their turn) -->
        <button
          class="btn btn-secondary"
          id="stand"
          type="button"
          onclick="dealerFinish()"
        >
          Stand
        </button>

        <!-- Button to start a new game, initially disabled -->
        <button
          class="btn btn-success"
          id="new_game"
          type="button"
          onclick="newGame()"
          disabled
        >
          New Game
        </button>
      </section>

      <!-- Section to display the game's status and messages -->
      <section id="game_status">
        <!-- This will be populated dynamically during the game -->
      </section>

      <!-- Debugging section for developers to view game state -->
      <section id="sec_debug">
        <h2>Debug</h2>
        <!-- Subheading for the debug section -->
        <p id="debug">
          <!-- Placeholder for displaying debug information -->
        </p>
      </section>
    </main>

    <!-- Footer section, currently empty -->
    <footer class="container">
      <!-- Any footer content can be added here -->
    </footer>

    <!-- ===== GAME START MENU OVERLAY ===== -->
    <div id="start-menu">
      <div id="start-menu-content" class="text-center text-light p-4 rounded">
        <h2 class="mb-4">Blackjack 25</h2>
        <button id="btn-start" class="btn btn-success w-100 mb-3">
          Start Game
        </button>
        <button id="btn-quit" class="btn btn-danger w-100">Quit</button>
      </div>
    </div>

    <!-- Settings / Hamburger Menu -->
    <div id="settings-menu">
      <button
        id="settings-toggle"
        class="btn btn-outline-light"
        style="
          position: fixed;
          top: 1rem;
          right: 1rem;
          z-index: 10000;
          background: rgba(33, 37, 41, 0.9);
          border: none;
          border-radius: 0.5rem;
        "
      >
        <i class="bi bi-list" style="font-size: 1.5rem"></i>
      </button>

      <div
        id="settings-panel"
        class="card text-light bg-dark"
        style="
          position: fixed;
          top: 4rem;
          right: 1rem;
          width: 250px;
          display: none;
          z-index: 9999;
          border-radius: 1rem;
          box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        "
      >
        <div class="card-body">
          <h5 class="card-title mb-3">Settings</h5>
          <hr class="border-secondary" />

          <!-- Music Section -->
          <div class="mb-3">
            <h6>Music</h6>
            <button id="music-toggle" class="btn btn-sm btn-success w-100 mb-2">
              Toggle Music
            </button>
            <label for="music-volume" class="form-label small"
              >Music Volume</label
            >
            <input
              type="range"
              id="music-volume"
              min="0"
              max="1"
              step="0.01"
              value="1"
              class="form-range"
            />
          </div>
          <!-- VFX Section -->
          <div class="mb-3">
            <h6>VFX</h6>
            <button id="vfx-toggle" class="btn btn-sm btn-danger w-100 mb-2">
              Mute VFX
            </button>
            <label for="vfx-volume" class="form-label small">VFX Volume</label>
            <input
              type="range"
              id="vfx-volume"
              min="0"
              max="1"
              step="0.01"
              value="1"
              class="form-range"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Link your music script -->
    <script src="js/bg_music.js"></script>

    <!-- Link to Bootstrap's JavaScript bundle for interactive components -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="js/card.js"></script>

    <!-- Link to the JavaScript file containing the Blackjack game logic -->
    <script src="js/blackjack_object.js"></script>

    <!-- Link to the JavaScript file for managing game actions and events -->
    <script src="js/blackjack_manager.js"></script>

    <!-- Execute the newGame function when the window loads to start the game -->
    <script>
      window.onload = () => {
        // Page loads, show menu but don't start game yet
        document.getElementById("start-menu").style.display = "flex";

        // Disable gameplay buttons initially
        document.getElementById("card").disabled = true;
        document.getElementById("stand").disabled = true;
        document.getElementById("new_game").disabled = true;

        // Setup menu button logic
        const btnStart = document.getElementById("btn-start");
        const btnQuit = document.getElementById("btn-quit");

        btnStart.addEventListener("click", () => {
          primeAudio(); // unlocks sound context
          document.getElementById("start-menu").style.display = "none"; // hide menu
          newGame(); // start the actual game
        });

        btnQuit.addEventListener("click", () => {
          window.close(); // tries to close tab
          // fallback: navigate away if close is blocked
          setTimeout(() => (window.location.href = "about:blank"), 500);
        });
      };
    </script>
  </body>
</html>
